<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Movement Tracing in Android" /><meta name="author" content="Saket Upadhyay" /><meta property="og:locale" content="en" /><meta name="description" content="Android already have accurate Geo location capabilities by using multiple sources like Cellular Networks, G.P.S. and nearby Wi-Fi connections. And that’s handful of sources to extract information from, but their working and synchronisation among each other is real beauty. I also want to share my views on “Location Detection” and “Location Tracing”, there is a difference between “Locating” something and Tracking/Tracing something, android’s pretty accurate in pointing you on globe, and of course we can use classes with some location permissions to request for location information but that would only give us a set of LAT,LON format integers to work with ; from that information we can only point someone/something (cause now-a-days things do have internet) so how to trace that movement?" /><meta property="og:description" content="Android already have accurate Geo location capabilities by using multiple sources like Cellular Networks, G.P.S. and nearby Wi-Fi connections. And that’s handful of sources to extract information from, but their working and synchronisation among each other is real beauty. I also want to share my views on “Location Detection” and “Location Tracing”, there is a difference between “Locating” something and Tracking/Tracing something, android’s pretty accurate in pointing you on globe, and of course we can use classes with some location permissions to request for location information but that would only give us a set of LAT,LON format integers to work with ; from that information we can only point someone/something (cause now-a-days things do have internet) so how to trace that movement?" /><link rel="canonical" href="/blog/posts/Live-Movement-Tracing-in-Android-using-Polygraph-Lines/" /><meta property="og:url" content="/blog/posts/Live-Movement-Tracing-in-Android-using-Polygraph-Lines/" /><meta property="og:site_name" content="Saket’s Blog" /><meta property="og:image" content="https://miro.medium.com/max/500/1*7FVgHe-XObuWDbCOYM4wdA.jpeg" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-07-15T12:12:12+05:30" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://miro.medium.com/max/500/1*7FVgHe-XObuWDbCOYM4wdA.jpeg" /><meta property="twitter:title" content="Movement Tracing in Android" /><meta name="twitter:site" content="@saketofcyber" /><meta name="twitter:creator" content="@saketofcyber" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Saket Upadhyay","url":"https://github.com/Saket-Upadhyay/"},"dateModified":"2019-07-15T12:12:12+05:30","datePublished":"2019-07-15T12:12:12+05:30","description":"Android already have accurate Geo location capabilities by using multiple sources like Cellular Networks, G.P.S. and nearby Wi-Fi connections. And that’s handful of sources to extract information from, but their working and synchronisation among each other is real beauty. I also want to share my views on “Location Detection” and “Location Tracing”, there is a difference between “Locating” something and Tracking/Tracing something, android’s pretty accurate in pointing you on globe, and of course we can use classes with some location permissions to request for location information but that would only give us a set of LAT,LON format integers to work with ; from that information we can only point someone/something (cause now-a-days things do have internet) so how to trace that movement?","headline":"Movement Tracing in Android","image":"https://miro.medium.com/max/500/1*7FVgHe-XObuWDbCOYM4wdA.jpeg","mainEntityOfPage":{"@type":"WebPage","@id":"/blog/posts/Live-Movement-Tracing-in-Android-using-Polygraph-Lines/"},"url":"/blog/posts/Live-Movement-Tracing-in-Android-using-Polygraph-Lines/"}</script><title>Movement Tracing in Android | Saket's Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Saket's Blog"><meta name="application-name" content="Saket's Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/blog/" class="mx-auto"> <img src="/blog/assets/prof.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/blog/">Saket's Blog</a></div><div class="site-subtitle font-italic">CS Ph.D. Student @ UVa</div></div><ul class="w-100"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Saket-Upadhyay" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/saketofcyber" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.linkedin.com/in/saketupadhyay/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/blog/"> Home </a> </span> <span>Movement Tracing in Android</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Movement Tracing in Android</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1563172932" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 15, 2019 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/Saket-Upadhyay/">Saket Upadhyay</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1629 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p>Android already have accurate Geo location capabilities by using multiple sources like Cellular Networks, G.P.S. and nearby Wi-Fi connections. And that’s handful of sources to extract information from, but their working and synchronisation among each other is real beauty. I also want to share my views on “Location Detection” and “Location Tracing”, there is a difference between “Locating” something and Tracking/Tracing something, android’s pretty accurate in pointing you on globe, and of course we can use classes with some location permissions to request for location information but that would only give us a set of LAT,LON format integers to work with ; from that information we can only point someone/something (cause now-a-days things do have internet) so how to trace that movement? <img data-src="https://miro.medium.com/max/500/1*7FVgHe-XObuWDbCOYM4wdA.jpeg" alt="Screen Shot 1" title="Application Screen Shot" data-proofer-ignore></p><div class="message">In this write up i will use my selected location which is less concentrated like city to make things more clear and i had more space to roam here and there in any direction to test the application.</div><h3 id="some-thoughts-on-security-and-location-tracing"><span class="mr-2">Some thoughts on Security and Location Tracing</span><a href="#some-thoughts-on-security-and-location-tracing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>As a citizen of digital age and a cybersecurity student you cannot stop yourself thinking about implementation of things on the field.</p><p>As we know knowing someone’s current location can give attacker a high attacking ground but knowing exactly where someone is going with which path is generally followed will help him in creating better plotted trap!</p><p>The attacker can know where you are actually going and what’s your daily commute routine and plan accordingly.</p><h4 id="prevention"><span class="mr-2">Prevention?</span><a href="#prevention" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Just turning off the GPS will not help much, as you will see in this post later, we can get location based on mobile network and nearby wifi networks too.</p><p>Just lookout for unknown apps and sudden/ suspicious activation of GPS / Location services. as google tries to get most precise information so it may trigger “Networks+WiFi+GPS High Performance” which you usually can’t miss.</p><h3 id="idea-behind-movement-tracing"><span class="mr-2">Idea behind Movement Tracing.</span><a href="#idea-behind-movement-tracing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>So, the idea is pretty basic and actually we all learn it in our highschool mathematics, and that’s GRAPHS and how plotting works.</p><p>We already know that we can get longitudes and latitudes from google itself in our app, just like points on graph of globe, the idea is to collect those points and then make a line from one to each other … easy? yeah its kind of easy.</p><h3 id="applying-idea-via-code"><span class="mr-2">Applying Idea via code.</span><a href="#applying-idea-via-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>So first we need to get permissions from the user to use location and internet.</p><blockquote><p>&lt;uses-permission android:name=”android.permission.ACCESS_FINE_LOCATION” /&gt; &lt;uses-permission android:name=”android.permission.INTERNET” /&gt;</p></blockquote><p>after setting up permissions in Manifest.xml, we can proceed further and get our Google API key to use, yeah, to use google maps and related functions we need to grab those, but it’s easy process, here lemme attach a link to a dedicated tutorial if you need.</p><h5 id="google-api-android-sdk"><span class="mr-2"><a href="https://developers.google.com/maps/documentation/android-sdk/get-api-key"><span class="mr-2">Google API, Android SDK</a></span><a href="#google-api-android-sdk" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>so, as now you have the keys time to setup our app and get going …</p><p>The code is actually long enough to take up 2–3 pages here so I think it would be better to just port the code directly and from GitHub and then modify as it pleases you.</p><blockquote><p>Get the Repo from <a href="https://github.com/Saket-Upadhyay/LiveLocationTriangulation">GitHub</a></p></blockquote><h5 id="things-you-need-to-change-in-that-"><span class="mr-2">Things you need to change in that :</span><a href="#things-you-need-to-change-in-that-" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5><p>ENTER YOUR API KEY IN app/src/debug/res/values/google_maps_api.xml</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">”google_maps_key”</span> <span class="na">templateMergeStrategy=</span><span class="s">”preserve”</span> <span class="na">translatable=</span><span class="s">”false”</span><span class="nt">&gt;</span>YOUR-KEY-HERE<span class="nt">&lt;/string&gt;</span>
</pre></table></code></div></div><p>And that would just do it.</p><p>Clone the Repo and open it up in Android Studio, you may need to change some more code maybe to build it perfectly, cause no code I have ever cloned till now works in first go. ¯\<em>(ツ)</em>/¯</p><h3 id="lets-understand-the-working"><span class="mr-2">Let’s understand the working</span><a href="#lets-understand-the-working" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>For the first time I would suggest you to just build the application as it is so that you can follow with this write-up after that feel free to modify the app and use it as it pleases your creativity.</p><p>The app is divided in to 3 parts -</p><ul><li>Text Location Update<li>Location on Map<li>Using Polygraph and Algorithm to trace it on map</ul><h3 id="part-1"><span class="mr-2">Part 1:</span><a href="#part-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This just tests the location set we can request from Google Maps API and represent them in text, also we can get which MODE is used in the process (GPS,NETWORK,WIFI). <img data-src="https://miro.medium.com/max/1400/1*DAv3Pe_cFAZATxCxcu7GTg.jpeg" alt="Screen Shot2.jpg" title="Screen Shot2" data-proofer-ignore></p><h3 id="part-2"><span class="mr-2">Part 2:</span><a href="#part-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>This part integrates “Google Maps Activity” layout already available in Android Studio. The idea is to collect information from provider and then pass it to Maps Activity which will then place a marker on that location. <img data-src="https://miro.medium.com/max/1400/1*wq792anmgYKQ29zK10ONvw.jpeg" alt="Screen Shot3.jpg" title="Screen Shot3" data-proofer-ignore></p><h3 id="part-3"><span class="mr-2">Part 3:</span><a href="#part-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Well this is main section of the application which actually traces your location on map.</p><p>The steps executed in this part are important,</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>1. Get location from provider
2. Set Red marker on starting point / initial location
3. Set Location Listener to check for location change
4. When ever location change is detected will add a point over map
5. Draw line joining those points
6. Place Green marker over last point.
7. Loop 1–6 until application is closed / location provide is not available.
</pre></table></code></div></div><p>Check out this Code for a moment …</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">locationpolymorph.test.sacredcoder.livelocationtriangulation</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.Manifest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.app.Activity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.pm.PackageManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.Color</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.location.Address</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.location.Geocoder</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.location.Location</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.location.LocationListener</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.location.LocationManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Build</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.support.annotation.RequiresApi</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.support.v4.app.ActivityCompat</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.support.v4.app.FragmentActivity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.WindowManager</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.CameraUpdateFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.GoogleMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.OnMapReadyCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.SupportMapFragment</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.BitmapDescriptorFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.JointType</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.LatLng</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.Marker</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.MarkerOptions</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.Polyline</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.PolylineOptions</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">PolyMap</span> <span class="kd">extends</span> <span class="nc">FragmentActivity</span> <span class="kd">implements</span> <span class="nc">OnMapReadyCallback</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="nc">GoogleMap</span> <span class="n">mMap</span><span class="o">;</span>
    <span class="nc">Marker</span> <span class="n">marker</span><span class="o">;</span>
    <span class="nc">Marker</span> <span class="n">marker2</span><span class="o">;</span>
    <span class="nc">LocationListener</span> <span class="n">locationListener</span><span class="o">;</span>
    <span class="nc">LocationManager</span> <span class="n">locationManager</span><span class="o">;</span>
    <span class="kd">protected</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">REQUEST_LOCATION_PERMISSION</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

    <span class="c1">//for line</span>
    <span class="kd">private</span> <span class="nc">Polyline</span> <span class="n">polyline</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Activity</span> <span class="n">activity</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Boolean</span> <span class="n">flag</span><span class="o">=</span><span class="kc">true</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">LatLng</span><span class="o">&gt;</span> <span class="n">polylinePoints</span><span class="o">;</span>
    <span class="nd">@RequiresApi</span><span class="o">(</span><span class="n">api</span> <span class="o">=</span> <span class="nc">Build</span><span class="o">.</span><span class="na">VERSION_CODES</span><span class="o">.</span><span class="na">P</span><span class="o">)</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_poly_map</span><span class="o">);</span>
        <span class="n">getWindow</span><span class="o">().</span><span class="na">addFlags</span><span class="o">(</span><span class="nc">WindowManager</span><span class="o">.</span><span class="na">LayoutParams</span><span class="o">.</span><span class="na">FLAG_KEEP_SCREEN_ON</span><span class="o">);</span>
        <span class="c1">// Obtain the SupportMapFragment and get notified when the map is ready to be used.</span>
        <span class="nc">SupportMapFragment</span> <span class="n">mapFragment</span> <span class="o">=</span> <span class="o">(</span><span class="nc">SupportMapFragment</span><span class="o">)</span> <span class="n">getSupportFragmentManager</span><span class="o">()</span>
                <span class="o">.</span><span class="na">findFragmentById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">mapp</span><span class="o">);</span>
        <span class="n">mapFragment</span><span class="o">.</span><span class="na">getMapAsync</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">polylinePoints</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
        <span class="n">locationManager</span> <span class="o">=</span> <span class="o">(</span><span class="nc">LocationManager</span><span class="o">)</span> <span class="n">getSystemService</span><span class="o">(</span><span class="no">LOCATION_SERVICE</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(</span><span class="nc">ActivityCompat</span><span class="o">.</span><span class="na">checkSelfPermission</span><span class="o">(</span><span class="k">this</span><span class="o">,</span>
                <span class="nc">Manifest</span><span class="o">.</span><span class="na">permission</span><span class="o">.</span><span class="na">ACCESS_FINE_LOCATION</span><span class="o">)</span>
                <span class="o">!=</span> <span class="nc">PackageManager</span><span class="o">.</span><span class="na">PERMISSION_GRANTED</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">ActivityCompat</span><span class="o">.</span><span class="na">requestPermissions</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="k">new</span> <span class="nc">String</span><span class="o">[]</span>
                            <span class="o">{</span><span class="nc">Manifest</span><span class="o">.</span><span class="na">permission</span><span class="o">.</span><span class="na">ACCESS_FINE_LOCATION</span><span class="o">},</span>
                    <span class="no">REQUEST_LOCATION_PERMISSION</span><span class="o">);</span>
        <span class="o">}</span>
<span class="c1">//polyline.setColor(Color.GREEN);</span>

        <span class="n">locationListener</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocationListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onLocationChanged</span><span class="o">(</span><span class="nc">Location</span> <span class="n">location</span><span class="o">)</span> <span class="o">{</span>

                <span class="c1">//if(location.hasAccuracy()) {</span>
                  <span class="c1">//  if (location.getAccuracy() &lt; 20.0f) {</span>
                        <span class="kt">double</span> <span class="n">latitude</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getLatitude</span><span class="o">();</span>
                        <span class="kt">double</span> <span class="n">longitude</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="na">getLongitude</span><span class="o">();</span>

                        <span class="c1">//get the location name from latitude and longitude</span>
                        <span class="nc">Geocoder</span> <span class="n">geocoder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Geocoder</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">());</span>
                        <span class="k">try</span> <span class="o">{</span>
                            <span class="nc">List</span><span class="o">&lt;</span><span class="nc">Address</span><span class="o">&gt;</span> <span class="n">addresses</span> <span class="o">=</span>
                                    <span class="n">geocoder</span><span class="o">.</span><span class="na">getFromLocation</span><span class="o">(</span><span class="n">latitude</span><span class="o">,</span> <span class="n">longitude</span><span class="o">,</span> <span class="mi">1</span><span class="o">);</span>
                            <span class="nc">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">addresses</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getLocality</span><span class="o">()</span> <span class="o">+</span> <span class="s">":"</span><span class="o">;</span>
                            <span class="n">result</span> <span class="o">+=</span> <span class="n">addresses</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getCountryName</span><span class="o">();</span>
                            <span class="nc">LatLng</span> <span class="n">latLng</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LatLng</span><span class="o">(</span><span class="n">latitude</span><span class="o">,</span> <span class="n">longitude</span><span class="o">);</span>


                            <span class="k">if</span> <span class="o">(</span><span class="n">flag</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">marker2</span> <span class="o">=</span> <span class="n">mMap</span><span class="o">.</span><span class="na">addMarker</span><span class="o">(</span><span class="k">new</span> <span class="nc">MarkerOptions</span><span class="o">().</span><span class="na">position</span><span class="o">(</span><span class="n">latLng</span><span class="o">).</span><span class="na">title</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">icon</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">defaultMarker</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">HUE_ROSE</span><span class="o">)));</span>
                            <span class="o">}</span>


                            <span class="k">if</span> <span class="o">(</span><span class="n">marker</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">marker</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>

                                <span class="n">marker</span> <span class="o">=</span> <span class="n">mMap</span><span class="o">.</span><span class="na">addMarker</span><span class="o">(</span><span class="k">new</span> <span class="nc">MarkerOptions</span><span class="o">().</span><span class="na">position</span><span class="o">(</span><span class="n">latLng</span><span class="o">).</span><span class="na">title</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">icon</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">defaultMarker</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">HUE_GREEN</span><span class="o">)));</span>
                                <span class="n">mMap</span><span class="o">.</span><span class="na">setMaxZoomPreference</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
                                <span class="n">mMap</span><span class="o">.</span><span class="na">moveCamera</span><span class="o">(</span><span class="nc">CameraUpdateFactory</span><span class="o">.</span><span class="na">newLatLngZoom</span><span class="o">(</span><span class="n">latLng</span><span class="o">,</span> <span class="mf">18.0f</span><span class="o">));</span>

                            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                <span class="n">marker</span> <span class="o">=</span> <span class="n">mMap</span><span class="o">.</span><span class="na">addMarker</span><span class="o">(</span><span class="k">new</span> <span class="nc">MarkerOptions</span><span class="o">().</span><span class="na">position</span><span class="o">(</span><span class="n">latLng</span><span class="o">).</span><span class="na">title</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">icon</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">defaultMarker</span><span class="o">(</span><span class="mf">120.0f</span><span class="o">)));</span>
                                <span class="n">mMap</span><span class="o">.</span><span class="na">setMaxZoomPreference</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
                                <span class="n">mMap</span><span class="o">.</span><span class="na">moveCamera</span><span class="o">(</span><span class="nc">CameraUpdateFactory</span><span class="o">.</span><span class="na">newLatLngZoom</span><span class="o">(</span><span class="n">latLng</span><span class="o">,</span> <span class="mf">18.0f</span><span class="o">));</span>
                            <span class="o">}</span>

                            <span class="n">polylinePoints</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">latLng</span><span class="o">);</span>


                            <span class="k">if</span> <span class="o">(</span><span class="n">polyline</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                                <span class="n">polyline</span><span class="o">.</span><span class="na">setPoints</span><span class="o">(</span><span class="n">polylinePoints</span><span class="o">);</span>

                            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                                <span class="n">polyline</span> <span class="o">=</span> <span class="n">mMap</span><span class="o">.</span><span class="na">addPolyline</span><span class="o">(</span><span class="k">new</span> <span class="nc">PolylineOptions</span><span class="o">().</span><span class="na">addAll</span><span class="o">(</span><span class="n">polylinePoints</span><span class="o">).</span><span class="na">color</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="na">MAGENTA</span><span class="o">).</span><span class="na">jointType</span><span class="o">(</span><span class="nc">JointType</span><span class="o">.</span><span class="na">ROUND</span><span class="o">).</span><span class="na">width</span><span class="o">(</span><span class="mf">3.0f</span><span class="o">));</span>
                            <span class="o">}</span>

                            <span class="n">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>


                        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                        <span class="o">}</span>
                  <span class="c1">//  }</span>
                <span class="c1">//}</span>
            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onStatusChanged</span><span class="o">(</span><span class="nc">String</span> <span class="n">provider</span><span class="o">,</span> <span class="kt">int</span> <span class="n">status</span><span class="o">,</span> <span class="nc">Bundle</span> <span class="n">extras</span><span class="o">)</span> <span class="o">{</span>

            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onProviderEnabled</span><span class="o">(</span><span class="nc">String</span> <span class="n">provider</span><span class="o">)</span> <span class="o">{</span>

            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onProviderDisabled</span><span class="o">(</span><span class="nc">String</span> <span class="n">provider</span><span class="o">)</span> <span class="o">{</span>

            <span class="o">}</span>
        <span class="o">};</span>
        <span class="n">locationManager</span><span class="o">.</span><span class="na">requestLocationUpdates</span><span class="o">(</span><span class="nc">LocationManager</span><span class="o">.</span><span class="na">NETWORK_PROVIDER</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">locationListener</span><span class="o">);</span>
        <span class="n">locationManager</span><span class="o">.</span><span class="na">requestLocationUpdates</span><span class="o">(</span><span class="nc">LocationManager</span><span class="o">.</span><span class="na">GPS_PROVIDER</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">locationListener</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="c1">//TO MANAGE THE MAP AS ONE WHEN THE MAP VIEW IS AVAILABLE FOR THE USER.</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onMapReady</span><span class="o">(</span><span class="nc">GoogleMap</span> <span class="n">googleMap</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mMap</span> <span class="o">=</span> <span class="n">googleMap</span><span class="o">;</span>
        <span class="n">mMap</span><span class="o">.</span><span class="na">setMapType</span><span class="o">(</span><span class="n">mMap</span><span class="o">.</span><span class="na">MAP_TYPE_SATELLITE</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onStop</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onStop</span><span class="o">();</span>
        <span class="n">locationManager</span><span class="o">.</span><span class="na">removeUpdates</span><span class="o">(</span><span class="n">locationListener</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">//CLOSE THE SESSION WHEN THE BACK IS PRESSED.</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onBackPressed</span><span class="o">()</span>
    <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onBackPressed</span><span class="o">();</span>
        <span class="k">this</span><span class="o">.</span><span class="na">finish</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>We can see here what ‘Location Listener’ is actually doing,</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">locationListener</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">LocationListener</span><span class="o">()</span> <span class="o">{</span> <span class="nd">@Override</span> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onLocationChanged</span><span class="o">(</span><span class="nc">Location</span> <span class="n">location</span><span class="o">)</span>
</pre></table></code></div></div><p>It is also interesting to see how we choose most precise location provider available</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">onProviderDisabled</span><span class="o">(</span><span class="nc">String</span> <span class="n">provider</span><span class="o">)</span> <span class="o">{</span> <span class="o">}</span> <span class="o">};</span><span class="n">locationManager</span><span class="o">.</span><span class="na">requestLocationUpdates</span><span class="o">(</span><span class="nc">LocationManager</span><span class="o">.</span><span class="na">NETWORK_PROVIDER</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">locationListener</span><span class="o">);</span> <span class="n">locationManager</span><span class="o">.</span><span class="na">requestLocationUpdates</span><span class="o">(</span><span class="nc">LocationManager</span><span class="o">.</span><span class="na">GPS_PROVIDER</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">locationListener</span><span class="o">);</span> <span class="o">}</span>
</pre></table></code></div></div><p>The next thing in this code to notice is how we are managing Polygraph Lines and Markers together to create lines on map</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.Marker</span><span class="o">;</span>   
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.MarkerOptions</span><span class="o">;</span> 
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.Polyline</span><span class="o">;</span>    
<span class="kn">import</span> <span class="nn">com.google.android.gms.maps.model.PolylineOptions</span><span class="o">;</span>
</pre></table></code></div></div><p>next comes the code for step 2,4 and 5</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="o">(</span><span class="n">marker</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
<span class="n">marker</span><span class="o">.</span><span class="na">remove</span><span class="o">();</span>
<span class="n">marker</span> <span class="o">=</span> <span class="n">mMap</span><span class="o">.</span><span class="na">addMarker</span><span class="o">(</span><span class="k">new</span> <span class="nc">MarkerOptions</span><span class="o">().</span><span class="na">position</span><span class="o">(</span><span class="n">latLng</span><span class="o">).</span><span class="na">title</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">icon</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">defaultMarker</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">HUE_GREEN</span><span class="o">)));</span>
<span class="n">mMap</span><span class="o">.</span><span class="na">setMaxZoomPreference</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
<span class="n">mMap</span><span class="o">.</span><span class="na">moveCamera</span><span class="o">(</span><span class="nc">CameraUpdateFactory</span><span class="o">.</span><span class="na">newLatLngZoom</span><span class="o">(</span><span class="n">latLng</span><span class="o">,</span> <span class="mf">18.0f</span><span class="o">));</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="n">marker</span> <span class="o">=</span> <span class="n">mMap</span><span class="o">.</span><span class="na">addMarker</span><span class="o">(</span><span class="k">new</span> <span class="nc">MarkerOptions</span><span class="o">().</span><span class="na">position</span><span class="o">(</span><span class="n">latLng</span><span class="o">).</span><span class="na">title</span><span class="o">(</span><span class="n">result</span><span class="o">).</span><span class="na">icon</span><span class="o">(</span><span class="nc">BitmapDescriptorFactory</span><span class="o">.</span><span class="na">defaultMarker</span><span class="o">(</span><span class="mf">120.0f</span><span class="o">)));</span>
<span class="n">mMap</span><span class="o">.</span><span class="na">setMaxZoomPreference</span><span class="o">(</span><span class="mi">20</span><span class="o">);</span>
<span class="n">mMap</span><span class="o">.</span><span class="na">moveCamera</span><span class="o">(</span><span class="nc">CameraUpdateFactory</span><span class="o">.</span><span class="na">newLatLngZoom</span><span class="o">(</span><span class="n">latLng</span><span class="o">,</span> <span class="mf">18.0f</span><span class="o">));</span>
<span class="o">}</span>
<span class="n">polylinePoints</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">latLng</span><span class="o">);</span>
</pre></table></code></div></div><p>here we check marker position and add new points to our PolyLine</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="o">(</span><span class="n">polyline</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
  <span class="n">polyline</span><span class="o">.</span><span class="na">setPoints</span><span class="o">(</span><span class="n">polylinePoints</span><span class="o">);</span>
<span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
<span class="n">polyline</span> <span class="o">=</span> <span class="n">mMap</span><span class="o">.</span><span class="na">addPolyline</span><span class="o">(</span><span class="k">new</span> <span class="nc">PolylineOptions</span><span class="o">().</span><span class="na">addAll</span><span class="o">(</span><span class="n">polylinePoints</span><span class="o">).</span><span class="na">color</span><span class="o">(</span><span class="nc">Color</span><span class="o">.</span><span class="na">MAGENTA</span><span class="o">).</span><span class="na">jointType</span><span class="o">(</span><span class="nc">JointType</span><span class="o">.</span><span class="na">ROUND</span><span class="o">).</span><span class="na">width</span><span class="o">(</span><span class="mf">3.0f</span><span class="o">));</span>
<span class="o">}</span>  
<span class="n">flag</span> <span class="o">=</span> <span class="kc">false</span><span class="o">;</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span><span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>                           
<span class="o">}</span>
</pre></table></code></div></div><p>above code checks PolyLine and draws it over GoogleMap activity.</p><p>Compiling all above steps and logic, we got a cute and precise trace line over Satellite Map.</p><p><img data-src="https://miro.medium.com/max/1000/1*qpEIDypfzkTvHotYjn6Tdw.jpeg" alt="Sat. Trace SS.jpg" title="Sat Screenshot" data-proofer-ignore></p><h3 id="what-next"><span class="mr-2">What next?</span><a href="#what-next" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Well… Now you know how to trace location over maps, like a cool modern cartographer 😬. Your imagination is the limit.</p><p>some ideas :</p><ul><li>The points of polygraphs, if stored in arrays or any of your fav. data structure can be passed to your database and then share that with your other apps to live track group of friends together.<li>Can run this service in background to store data points and then draw them whenever needed.</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/blog/categories/misc/'>Misc.</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/blog/tags/android/" class="post-tag no-text-decoration" >android</a> <a href="/blog/tags/project/" class="post-tag no-text-decoration" >project</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Movement+Tracing+in+Android+-+Saket%27s+Blog&url=%2Fblog%2Fposts%2FLive-Movement-Tracing-in-Android-using-Polygraph-Lines%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Movement+Tracing+in+Android+-+Saket%27s+Blog&u=%2Fblog%2Fposts%2FLive-Movement-Tracing-in-Android-using-Polygraph-Lines%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fblog%2Fposts%2FLive-Movement-Tracing-in-Android-using-Polygraph-Lines%2F&text=Movement+Tracing+in+Android+-+Saket%27s+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=%2Fblog%2Fposts%2FLive-Movement-Tracing-in-Android-using-Polygraph-Lines%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/ctf-writeup/">ctf writeup</a> <a class="post-tag" href="/blog/tags/android/">android</a> <a class="post-tag" href="/blog/tags/ctf/">ctf</a> <a class="post-tag" href="/blog/tags/encryption/">encryption</a> <a class="post-tag" href="/blog/tags/malware-analysis/">malware analysis</a> <a class="post-tag" href="/blog/tags/privacy/">privacy</a> <a class="post-tag" href="/blog/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/blog/tags/assembly/">Assembly</a> <a class="post-tag" href="/blog/tags/brainfuck/">brainfuck</a> <a class="post-tag" href="/blog/tags/crunch/">crunch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/blog/posts/sstf-vault-wtireup/"><div class="card-body"> <em class="small" data-ts="1597732932" data-df="ll" > Aug 18, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Samsung CTF App Reverse Eng. Writeup</h3><div class="text-muted small"><p> A writeup of Reverse Engineering Challenge of Samsung CTF &quot;Hacker&#39;s Playground 2020&quot; Points : 500 Solves : 15 I took part in Samsung’s CTF event and tried to do some reverse engineering challe...</p></div></div></a></div><div class="card"> <a href="/blog/posts/Effortless-Feature-Extraction/"><div class="card-body"> <em class="small" data-ts="1575441732" data-df="ll" > Dec 4, 2019 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Effortless Feature Extraction</h3><div class="text-muted small"><p> Streamline Permission-Based Feature Extraction for android data-set with one Python Script. Malware detection and analysis has been the hot topic in security for a long time, overtime the malwar...</p></div></div></a></div><div class="card"> <a href="/blog/posts/code-brainfuck/"><div class="card-body"> <em class="small" data-ts="1600194600" data-df="ll" > Sep 16, 2020 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to (code in) BrainF*ck?</h3><div class="text-muted small"><p> A DETAILED GUIDE ON BRAINF*CK FOR BEGINNERS AND ENTHUSIASTS. Brainfuck is the most famous esoteric programming language, and has inspired the creation of a host of other languages. Due to the fa...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"><div class="btn btn-outline-primary disabled" prompt="Older"><p>-</p></div><a href="/blog/posts/Pipe-Brute-force-Attack-via-Password-Generator/" class="btn btn-outline-primary" prompt="Newer"><p>Brute-force Attack via Pass. Gen.</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"><p xmlns:cc="http://creativecommons.org/ns#" xmlns:dct="http://purl.org/dc/terms/"><a property="dct:title" rel="cc:attributionURL" href="https://saket-upadhyay.github.io/blog">Saket's Blog</a> by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://saket-upadhyay.github.io">Saket Upadhyay</a> is licensed under <a href="http://creativecommons.org/licenses/by-sa/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">CC BY-SA 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="https://mirrors.creativecommons.org/presskit/icons/sa.svg"></a></p></p></div><div class="footer-right"><p class="mb-0"> Powered by Jekyll.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/blog/tags/ctf-writeup/">ctf writeup</a> <a class="post-tag" href="/blog/tags/android/">android</a> <a class="post-tag" href="/blog/tags/ctf/">ctf</a> <a class="post-tag" href="/blog/tags/encryption/">encryption</a> <a class="post-tag" href="/blog/tags/malware-analysis/">malware analysis</a> <a class="post-tag" href="/blog/tags/privacy/">privacy</a> <a class="post-tag" href="/blog/tags/reverse-engineering/">reverse engineering</a> <a class="post-tag" href="/blog/tags/assembly/">Assembly</a> <a class="post-tag" href="/blog/tags/brainfuck/">brainfuck</a> <a class="post-tag" href="/blog/tags/crunch/">crunch</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/blog/app.js"></script>
